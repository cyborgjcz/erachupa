;
;유사 와이어프레임 3D 던전 크롤러의 그래픽
;D3D_DIAGONALLINE_1,D3D_DIAGONALLINE_2,D3D_VERTICALLINE
;D3D_HORIZONTALLINE 4개의 스프라이트를 resources 폴더에 탑재해야함
;
@D3D_SHOW_GRAPHIC
#DIM DYNAMIC LCOUNT;FOR 구문을 위한 반복카운터
#DIM DYNAMIC LSWITCHARRAY,33
#DIM DYNAMIC LWALLCHECK,12,4
#DIMS DYNAMIC HTMLTEXT;맵을 그리는 이미지를 출력하기 위한 HTML_PRINT 문자열

#DIM DYNAMIC LCOUNT2;2중 FOR 구문을 위한 반복카운터
#DIM DYNAMIC LSKIP = 0;맵 상 아이콘 변수 표시 반복문에서 사용하는 스위치 변수

;판정 초기화
FOR LCOUNT,0,33
    LSWITCHARRAY:LCOUNT = 0
NEXT

;LWALLCHECK:~:~ 배열변수에 벽판정 결과를 일괄 저장한다
;0은 제자리,1은 심도0 왼쪽칸,2는 심도0 오른쪽칸,
;3은 심도1 가운데, 4는 심도1 왼쪽... 9는 심도3가운데칸이다
CALL D3D_CHECK_WALL(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD,,1)
LWALLCHECK:1:0 = RESULT:0,RESULT:1,RESULT:2,RESULT:3
CALL D3D_GET_LEFT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
CALL D3D_CHECK_WALL(RESULT:0,RESULT:1,,1)
LWALLCHECK:0:0 = RESULT:0,RESULT:1,RESULT:2,RESULT:3
CALL D3D_GET_RIGHT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
CALL D3D_CHECK_WALL(RESULT:0,RESULT:1,,1)
LWALLCHECK:2:0 = RESULT:0,RESULT:1,RESULT:2,RESULT:3
CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
CALL D3D_CHECK_WALL(RESULT:0,RESULT:1,,1)
LWALLCHECK:4:0 = RESULT:0,RESULT:1,RESULT:2,RESULT:3
CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
CALL D3D_GET_LEFT_COORD(RESULT:0,RESULT:1)
CALL D3D_CHECK_WALL(RESULT:0,RESULT:1,,1)
LWALLCHECK:3:0 = RESULT:0,RESULT:1,RESULT:2,RESULT:3
CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
CALL D3D_GET_RIGHT_COORD(RESULT:0,RESULT:1)
CALL D3D_CHECK_WALL(RESULT:0,RESULT:1,,1)
LWALLCHECK:5:0 = RESULT:0,RESULT:1,RESULT:2,RESULT:3
CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
CALL D3D_CHECK_WALL(RESULT:0,RESULT:1,,1)
LWALLCHECK:7:0 = RESULT:0,RESULT:1,RESULT:2,RESULT:3
CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
CALL D3D_GET_LEFT_COORD(RESULT:0,RESULT:1)
CALL D3D_CHECK_WALL(RESULT:0,RESULT:1,,1)
LWALLCHECK:6:0 = RESULT:0,RESULT:1,RESULT:2,RESULT:3
CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
CALL D3D_GET_RIGHT_COORD(RESULT:0,RESULT:1)
CALL D3D_CHECK_WALL(RESULT:0,RESULT:1,,1)
LWALLCHECK:8:0 = RESULT:0,RESULT:1,RESULT:2,RESULT:3
CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
CALL D3D_CHECK_WALL(RESULT:0,RESULT:1,,1)
LWALLCHECK:9:0 = RESULT:0,RESULT:1,RESULT:2,RESULT:3
CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
CALL D3D_GET_LEFT_COORD(RESULT:0,RESULT:1)
CALL D3D_GET_LEFT_COORD(RESULT:0,RESULT:1)
CALL D3D_CHECK_WALL(RESULT:0,RESULT:1,,1)
LWALLCHECK:10:0 = RESULT:0,RESULT:1,RESULT:2,RESULT:3
CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
CALL D3D_GET_RIGHT_COORD(RESULT:0,RESULT:1)
CALL D3D_GET_RIGHT_COORD(RESULT:0,RESULT:1)
CALL D3D_CHECK_WALL(RESULT:0,RESULT:1,,1)
LWALLCHECK:11:0 = RESULT:0,RESULT:1,RESULT:2,RESULT:3

;LSWITCHARRAY 조작
;각 LSWITCHARRAY가 한 쌍 혹은 한 개의 HTML_PRINT 그래픽에 대응하고 있어
;1 또는 0을 대입하여 화면 상에 3D맵을 그리는 선분을 표시하는지 여부를 결정
;심도란 플레이어 위치를 기준으로 전방으로 멀리 떨어져서 더 깊은 시야에 표시하는 것을 의미
;심도0
SIF LWALLCHECK:1:3
    LSWITCHARRAY:0 = 1;심도0 왼쪽 대각선 (바로왼쪽이 벽이면
SIF LWALLCHECK:1:1
    LSWITCHARRAY:1 = 1;심도0 오른쪽 대각선 (바로 오른쪽이 벽이면
SIF LWALLCHECK:1:0
    LSWITCHARRAY:2 = 1;심도0중앙수평선 (바로앞이 벽이면 
SIF !LWALLCHECK:1:3 && LWALLCHECK:0:0
    LSWITCHARRAY:3 = 1;심도0수평선좌 바로왼쪽이 뚫, 심도0왼칸의 앞이 벽
SIF !LWALLCHECK:1:1 && LWALLCHECK:2:0
    LSWITCHARRAY:4 = 1;심도0수평선 우 바로오른쪽이 뚫,심도0오른칸의앞이벽
{
    SIF (LWALLCHECK:1:3 && LWALLCHECK:1:0) || (!LWALLCHECK:1:3 && LWALLCHECK:1:0 && !LWALLCHECK:0:0) ||
    (LWALLCHECK:1:3 && !LWALLCHECK:1:0 && ((!LWALLCHECK:4:3 || LWALLCHECK:4:3 == 2) ||
    (LWALLCHECK:1:3 == 2 && LWALLCHECK:4:3))) ||
    ((LWALLCHECK:1:0 && !LWALLCHECK:1:3 && LWALLCHECK:0:0) && (LWALLCHECK:1:0 == 2 || LWALLCHECK:0:0 ==2)) ||
    (!LWALLCHECK:1:0 && !LWALLCHECK:1:3 && LWALLCHECK:0:0 && LWALLCHECK:4:3)
}
    LSWITCHARRAY:5 = 1;수직선좌 바로왼쪽벽&바로앞벽 or 바로왼쪽뚫&바로앞벽&심도0왼칸앞뚫 or 바로왼쪽벽&바로앞뚫&심도1왼쪽뚫
{
    SIF (LWALLCHECK:1:1 && LWALLCHECK:1:0) || (!LWALLCHECK:1:1 && LWALLCHECK:1:0 && !LWALLCHECK:2:0) ||
    (LWALLCHECK:1:1 && !LWALLCHECK:1:0 && ((!LWALLCHECK:4:1 || LWALLCHECK:4:1 == 2) ||
    (LWALLCHECK:1:1 == 2 && LWALLCHECK:4:1))) ||
    ((LWALLCHECK:1:0 && !LWALLCHECK:1:1 && LWALLCHECK:2:0) && (LWALLCHECK:1:0 == 2 || LWALLCHECK:2:0 == 2)) ||
    (!LWALLCHECK:1:0 && !LWALLCHECK:1:1 && LWALLCHECK:2:0 && LWALLCHECK:4:1)
}
    LSWITCHARRAY:6 = 1;수직선우 윗줄의 반전
;심도1
IF !LWALLCHECK:1:0
    SIF LWALLCHECK:4:3
        LSWITCHARRAY:7 = 1;심도1 왼쪽 대각선 (심도0바로앞뚫&심도1왼쪽벽
    SIF LWALLCHECK:4:1
        LSWITCHARRAY:8 = 1;심도1 오른쪽 대각선 (심도0바로앞뚫&심도1오른쪽벽
    SIF LWALLCHECK:4:0
        LSWITCHARRAY:9 = 1;중앙수평선 (심도0바로앞뚫&심도1앞벽
    SIF LWALLCHECK:3:0 && !LWALLCHECK:4:3
        LSWITCHARRAY:10 = 1;심도1프레임 수평선좌 (심도1왼칸앞벽&심도1왼쪽뚫&심도0바로앞뚫
    SIF LWALLCHECK:5:0 && !LWALLCHECK:4:1
        LSWITCHARRAY:11 = 1;심도1프레임 수평선우
    {
        SIF (LWALLCHECK:4:3 && (!LWALLCHECK:7:3 || LWALLCHECK:7:3 == 2) ||
        (LWALLCHECK:4:3 == 2 && LWALLCHECK:7:3)) ||
        (!LWALLCHECK:4:3 && LWALLCHECK:7:3 && !(LWALLCHECK:4:0 && LWALLCHECK:3:0)) ||
        (LWALLCHECK:4:3 && LWALLCHECK:4:0) || (!LWALLCHECK:3:0 && LWALLCHECK:4:0) ||
        ((LWALLCHECK:4:0 && !LWALLCHECK:4:3 && LWALLCHECK:3:0) && (LWALLCHECK:4:0 == 2 || LWALLCHECK:3:0 ==2))
    }
        LSWITCHARRAY:14 = 1;수직선 좌
    {
        SIF (LWALLCHECK:4:1 && (!LWALLCHECK:7:1 || LWALLCHECK:7:1 == 2) ||
        (LWALLCHECK:4:1 == 2 && LWALLCHECK:7:1)) ||
        (!LWALLCHECK:4:1 && LWALLCHECK:7:1 && !(LWALLCHECK:4:0 && LWALLCHECK:5:0)) ||
        (LWALLCHECK:4:1 && LWALLCHECK:4:0) || (!LWALLCHECK:5:0 && LWALLCHECK:4:0) ||
        ((LWALLCHECK:4:0 && !LWALLCHECK:4:1 && LWALLCHECK:5:0) && (LWALLCHECK:4:0 == 2 || LWALLCHECK:5:0 ==2))
    }
        LSWITCHARRAY:15 = 1;수직선 우
ENDIF
SIF LWALLCHECK:3:0 && !LWALLCHECK:0:0 && !LWALLCHECK:1:3
    LSWITCHARRAY:12 = 1;심도0프레임 수평선좌
SIF LWALLCHECK:5:0 && !LWALLCHECK:2:0 && !LWALLCHECK:1:1
    LSWITCHARRAY:13 = 1;심도0프레임 수평선우
;심도2
IF !LWALLCHECK:1:0 && !LWALLCHECK:4:0
    SIF LWALLCHECK:7:3
        LSWITCHARRAY:16 = 1;심도2왼쪽대각선
    SIF LWALLCHECK:7:1
        LSWITCHARRAY:17 = 1;심도2오른쪽대각선
    SIF LWALLCHECK:7:0
        LSWITCHARRAY:18 = 1;심도2중앙수평선
    SIF LWALLCHECK:6:0 && !LWALLCHECK:7:3
        LSWITCHARRAY:19 = 1;심도2수평선좌
    SIF LWALLCHECK:8:0 && !LWALLCHECK:7:1
        LSWITCHARRAY:20 = 1;심도2수평선우
    {
        SIF (LWALLCHECK:7:3 && ((!LWALLCHECK:9:3 || LWALLCHECK:9:3 == 2) ||
        (LWALLCHECK:7:3 == 2 && LWALLCHECK:9:3))) ||
        (!LWALLCHECK:7:3 && LWALLCHECK:9:3 && !(LWALLCHECK:7:0 && LWALLCHECK:6:0)) ||
        (LWALLCHECK:7:3 && LWALLCHECK:7:0) || (!LWALLCHECK:6:0 && LWALLCHECK:7:0) ||
        ((LWALLCHECK:7:0 && !LWALLCHECK:7:3 && LWALLCHECK:6:0) && (LWALLCHECK:7:0 == 2 || LWALLCHECK:6:0 == 2))
    }
        LSWITCHARRAY:25 = 1;수직선 좌
    {
        SIF (LWALLCHECK:7:1 && ((!LWALLCHECK:9:1 || LWALLCHECK:9:1 == 2) ||
        (LWALLCHECK:7:1 == 2 && LWALLCHECK:9:1))) ||
        (!LWALLCHECK:7:1 && LWALLCHECK:9:1 && !(LWALLCHECK:7:0 && LWALLCHECK:8:0)) ||
        (LWALLCHECK:7:1 && LWALLCHECK:7:0) || (!LWALLCHECK:8:0 && LWALLCHECK:7:0) ||
        ((LWALLCHECK:7:0 && !LWALLCHECK:7:1 && LWALLCHECK:8:0) && (LWALLCHECK:7:0 == 2 || LWALLCHECK:8:0 == 2))
    }
        LSWITCHARRAY:26 = 1;수직선 우(심도2오른쪽벽&심도3오른쪽뚫 or 심도2오른쪽뚫&심도3오른쪽벽&(심도2앞과오른칸앞이둘다벽이면x) or 심도2오른쪽벽&심도2앞벽 or 심도2오른칸앞뚫&심도2앞벽 
ENDIF
SIF LWALLCHECK:6:0 && !LWALLCHECK:3:0 && !LWALLCHECK:4:3 && !LWALLCHECK:1:0
    LSWITCHARRAY:21 = 1;심도1프레임수평선좌
SIF LWALLCHECK:8:0 && !LWALLCHECK:5:0 && !LWALLCHECK:4:1 && !LWALLCHECK:1:0
    LSWITCHARRAY:22 = 1;심도1프레임수평선우
SIF LWALLCHECK:6:0 && !LWALLCHECK:6:3 && !LWALLCHECK:3:0 && !LWALLCHECK:0:0 && !LWALLCHECK:1:3
    LSWITCHARRAY:23 = 1;심도0프레임수평선좌
SIF LWALLCHECK:8:0 && !LWALLCHECK:8:1 && !LWALLCHECK:5:0 && !LWALLCHECK:2:0 && !LWALLCHECK:1:1
    LSWITCHARRAY:24 = 1;심도0프레임수평선우

SIF LWALLCHECK:6:3 && !LWALLCHECK:1:3 && !LWALLCHECK:0:0 && !LWALLCHECK:3:0
    LSWITCHARRAY:27 = 1;(심도2)심도0프레임대각선좌
SIF LWALLCHECK:8:1 && !LWALLCHECK:1:1 && !LWALLCHECK:2:0 && !LWALLCHECK:5:0
    LSWITCHARRAY:28 = 1;(심도2)심도0프레임대각선우
SIF LWALLCHECK:9:3 && !LWALLCHECK:1:0 && !LWALLCHECK:4:0 && !LWALLCHECK:7:0
    LSWITCHARRAY:29 = 1;심도3대각선좌
SIF LWALLCHECK:9:1 && !LWALLCHECK:1:0 && !LWALLCHECK:4:0 && !LWALLCHECK:7:0
    LSWITCHARRAY:30 = 1;심도3대각선우

{
    SIF (!LWALLCHECK:1:3 && !LWALLCHECK:0:0 && !LWALLCHECK:4:3 && !LWALLCHECK:3:0) &&
    ((LWALLCHECK:6:0 && LWALLCHECK:6:3) ||
    (!LWALLCHECK:6:0 && !LWALLCHECK:6:3 && LWALLCHECK:10:0) ||
    ((LWALLCHECK:6:0 && LWALLCHECK:10:0 && !LWALLCHECK:6:3) &&
    (LWALLCHECK:6:0 == 2 || LWALLCHECK:10:0 == 2)))
}
    LSWITCHARRAY:31 = 1;심도2수직선 좌좌
{
    SIF (!LWALLCHECK:1:1 && !LWALLCHECK:2:0 && !LWALLCHECK:4:1 && !LWALLCHECK:5:0) &&
    ((LWALLCHECK:8:0 && LWALLCHECK:8:1) ||
    (!LWALLCHECK:8:0 && !LWALLCHECK:8:1 && LWALLCHECK:11:0) ||
    ((LWALLCHECK:8:0 && LWALLCHECK:11:0 && !LWALLCHECK:8:1) &&
    (LWALLCHECK:8:0 == 2 || LWALLCHECK:11:0 == 2)))
}
    LSWITCHARRAY:32 = 1;심도2수직선 우우

;맵 상 아이콘 표시 여부 판정, 내용 확인 기능
;DUNGEON3D.ERB에 정의되어 있는 함수들을 호출하여 목표 좌표를 획득하고 벽/바닥 확인
;맵 상 아이콘 표시는 || OR 연산자를 사용하지 않는다.
;같은 화면상 위치에서 또는~ 으로 결정된다면 별개의 배열변수 인덱스로 지정함
FOR LCOUNT,0,39
    LSKIP = 0
    RESULT:0 = 0,0,0,0
    RESULTS =
    RESETCOLOR
    SELECTCASE LCOUNT
        CASE 0;심도0바로앞벽
            SIF LSWITCHARRAY:2
                CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
        CASE 1;심도2앞왼쪽벽
            IF !LSWITCHARRAY:7 && !LSWITCHARRAY:2
                CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
                CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
                CALL D3D_GET_LEFT_COORD(RESULT:0,RESULT:1)
                CALL D3D_WALL_OR_FLOOR(RESULT:0,RESULT:1)
                SIF RESULT:2 == 0
                    LSKIP = 1
            ENDIF
        CASE 2;심도2앞오른쪽벽
            IF !LSWITCHARRAY:8 && !LSWITCHARRAY:2
                CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
                CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
                CALL D3D_GET_RIGHT_COORD(RESULT:0,RESULT:1)
                CALL D3D_WALL_OR_FLOOR(RESULT:0,RESULT:1)
                SIF RESULT:2 == 0
                    LSKIP = 1
            ENDIF
        CASE 3;심도1앞왼쪽벽
            IF LSWITCHARRAY:7 && !LSWITCHARRAY:2
                CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
                CALL D3D_GET_LEFT_COORD(RESULT:0,RESULT:1)
            ENDIF
        CASE 4;심도0왼쪽벽
            SIF LSWITCHARRAY:0
                CALL D3D_GET_LEFT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
        CASE 5;심도1앞오른쪽벽
            IF LSWITCHARRAY:8 && !LSWITCHARRAY:2
                CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
                CALL D3D_GET_RIGHT_COORD(RESULT:0,RESULT:1)
            ENDIF
        CASE 6;심도0오른쪽칸앞벽
            SIF LSWITCHARRAY:1
                CALL D3D_GET_RIGHT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
        CASE 7;심도2왼쪽칸앞
            IF LSWITCHARRAY:19 && LSWITCHARRAY:21 && !LSWITCHARRAY:2 && !LSWITCHARRAY:9
                CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
                CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
                CALL D3D_GET_LEFT_COORD(RESULT:0,RESULT:1)
                CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
            ENDIF
        CASE 8;심도2오른쪽칸앞
            IF LSWITCHARRAY:20 && LSWITCHARRAY:22 && !LSWITCHARRAY:2 && !LSWITCHARRAY:9
                CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
                CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
                CALL D3D_GET_RIGHT_COORD(RESULT:0,RESULT:1)
                CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
            ENDIF
        CASE 9;심도2앞바닥
            IF !LSWITCHARRAY:2 && !LSWITCHARRAY:9
                CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
                CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
            ENDIF
        CASE 10;심도2왼쪽칸바닥
            IF !LSWITCHARRAY:2 && !LSWITCHARRAY:7
                CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
                CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
                CALL D3D_GET_LEFT_COORD(RESULT:0,RESULT:1)
                CALL D3D_WALL_OR_FLOOR(RESULT:0,RESULT:1)
                SIF RESULT:2 != 0
                    LSKIP = 1
            ENDIF
        CASE 11;심도2오른쪽칸바닥
            IF !LSWITCHARRAY:2 && !LSWITCHARRAY:8
                CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
                CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
                CALL D3D_GET_RIGHT_COORD(RESULT:0,RESULT:1)
                CALL D3D_WALL_OR_FLOOR(RESULT:0,RESULT:1)
                SIF RESULT:2 != 0
                    LSKIP = 1
            ENDIF
        CASE 12;심도1앞바닥
            IF !LSWITCHARRAY:2
                CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
            ENDIF
        CASE 13;심도1왼쪽칸바닥
            IF !LSWITCHARRAY:2 && !LSWITCHARRAY:7; && (LSWITCHARRAY:0 || LSWITCHARRAY:12)
                CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
                CALL D3D_GET_LEFT_COORD(RESULT:0,RESULT:1)
            ENDIF
        CASE 14;심도1오른쪽칸바닥
            IF !LSWITCHARRAY:2 && !LSWITCHARRAY:8; && (LSWITCHARRAY:1 || LSWITCHARRAY:13)
                CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
                CALL D3D_GET_RIGHT_COORD(RESULT:0,RESULT:1)
            ENDIF
        CASE 15;정중앙-2(심도1앞벽)
            IF LSWITCHARRAY:9
                CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
                CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
            ENDIF
        CASE 16;정중앙-3(심도2앞벽)
            IF !LSWITCHARRAY:9 && LSWITCHARRAY:18
                CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
                CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
                CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
            ENDIF
        CASE 17;정중앙-4(심도3앞벽)
            IF LSWITCHARRAY:29 || LSWITCHARRAY:30
                CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
                CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
                CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
                CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
            ENDIF
        CASE 18;심도3앞바닥
            IF !LSWITCHARRAY:2 && !LSWITCHARRAY:9 && !LSWITCHARRAY:18
                CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
                CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
                CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
            ENDIF
        CASE 19;심도1왼쪽칸바닥-정면가려짐
            IF LSWITCHARRAY:2 && !LSWITCHARRAY:0 && !LSWITCHARRAY:7 && !LSWITCHARRAY:3
                CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
                CALL D3D_GET_LEFT_COORD(RESULT:0,RESULT:1)
            ENDIF
        CASE 20;심도1오른쪽칸바닥-정면가려짐
            IF LSWITCHARRAY:2 && !LSWITCHARRAY:1 && !LSWITCHARRAY:8 && !LSWITCHARRAY:4
                CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
                CALL D3D_GET_RIGHT_COORD(RESULT:0,RESULT:1)
            ENDIF
        CASE 21;심도2왼쪽칸바닥-좌측가려짐
            IF !LSWITCHARRAY:2 && !LSWITCHARRAY:9 && (LSWITCHARRAY:7 || LSWITCHARRAY:10) && !LSWITCHARRAY:16
                CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
                CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
                CALL D3D_GET_LEFT_COORD(RESULT:0,RESULT:1)
            ENDIF
        CASE 22;심도2오른쪽칸바닥-우측가려짐
            IF !LSWITCHARRAY:2 && !LSWITCHARRAY:9 && (LSWITCHARRAY:8 || LSWITCHARRAY:11) && !LSWITCHARRAY:17
                CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
                CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
                CALL D3D_GET_RIGHT_COORD(RESULT:0,RESULT:1)
            ENDIF
        CASE 23;심도0왼쪽칸바닥
            SIF !LSWITCHARRAY:0
                CALL D3D_GET_LEFT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
        CASE 24;심도0오른쪽칸바닥
            SIF !LSWITCHARRAY:1
                CALL D3D_GET_RIGHT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
        CASE 25;심도2왼칸앞벽,심도1프레임에서 가려짐
            IF !LSWITCHARRAY:9 && LSWITCHARRAY:14 && LSWITCHARRAY:19 && !LSWITCHARRAY:21
                CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
                CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
                CALL D3D_GET_LEFT_COORD(RESULT:0,RESULT:1)
                CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
                CALL D3D_WALL_OR_FLOOR(RESULT:0,RESULT:1)
                SIF RESULT:2 == 0
                    LSKIP = 1
            ENDIF
        CASE 26;심도2오른칸앞벽,심도1프레임에서 가려짐
            IF !LSWITCHARRAY:9 && LSWITCHARRAY:15 && LSWITCHARRAY:20 && !LSWITCHARRAY:22
                CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
                CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
                CALL D3D_GET_RIGHT_COORD(RESULT:0,RESULT:1)
                CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
                CALL D3D_WALL_OR_FLOOR(RESULT:0,RESULT:1)
                SIF RESULT:2 == 0
                    LSKIP = 1
            ENDIF
        CASE 27;심도2왼쪽칸바닥,바로앞칸가려짐
            IF LSWITCHARRAY:2 && !LSWITCHARRAY:0 && !LSWITCHARRAY:7 && !LSWITCHARRAY:10 && !LSWITCHARRAY:3
                CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
                CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
                CALL D3D_GET_LEFT_COORD(RESULT:0,RESULT:1)
                CALL D3D_WALL_OR_FLOOR(RESULT:0,RESULT:1)
                SIF RESULT:2 != 0
                    LSKIP = 1
            ENDIF
        CASE 28;심도2오른칸바닥,바로앞칸가려짐
            IF LSWITCHARRAY:2 && !LSWITCHARRAY:1 && !LSWITCHARRAY:8 && !LSWITCHARRAY:11 && !LSWITCHARRAY:4
                CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
                CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
                CALL D3D_GET_RIGHT_COORD(RESULT:0,RESULT:1)
                CALL D3D_WALL_OR_FLOOR(RESULT:0,RESULT:1)
                SIF RESULT:2 != 0
                    LSKIP = 1
            ENDIF
        CASE 29;심도3왼쪽칸바닥
            IF !LSWITCHARRAY:2 && !LSWITCHARRAY:9 && !LSWITCHARRAY:19 && !LSWITCHARRAY:25
                CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
                CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
                CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
                CALL D3D_GET_LEFT_COORD(RESULT:0,RESULT:1)
                CALL D3D_WALL_OR_FLOOR(RESULT:0,RESULT:1)
                SIF RESULT:2 != 0
                    LSKIP = 1
            ENDIF
        CASE 30;심도3오른칸바닥
            IF !LSWITCHARRAY:2 && !LSWITCHARRAY:9 && !LSWITCHARRAY:20 && !LSWITCHARRAY:26
                CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
                CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
                CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
                CALL D3D_GET_RIGHT_COORD(RESULT:0,RESULT:1)
                CALL D3D_WALL_OR_FLOOR(RESULT:0,RESULT:1)
                SIF RESULT:2 != 0
                    LSKIP = 1
            ENDIF
        CASE 31;심도2 바로왼쪽벽
            IF LSWITCHARRAY:16
                CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
                CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
                CALL D3D_GET_LEFT_COORD(RESULT:0,RESULT:1)
                CALL D3D_WALL_OR_FLOOR(RESULT:0,RESULT:1)
                SIF RESULT:2 == 0
                    LSKIP = 1
            ENDIF
        CASE 32;심도2 바로오른쪽벽
            IF LSWITCHARRAY:17
                CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
                CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
                CALL D3D_GET_RIGHT_COORD(RESULT:0,RESULT:1)
                CALL D3D_WALL_OR_FLOOR(RESULT:0,RESULT:1)
                SIF RESULT:2 == 0
                    LSKIP = 1
            ENDIF
        CASE 33;심도3왼쪽칸왼쪽벽
            IF LSWITCHARRAY:29
                CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
                CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
                CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
                CALL D3D_GET_LEFT_COORD(RESULT:0,RESULT:1)
                CALL D3D_WALL_OR_FLOOR(RESULT:0,RESULT:1,1)
                SIF RESULT:2 == 0
                    LSKIP = 1
            ENDIF
        CASE 34;심도3오른쪽칸왼쪽벽
            IF LSWITCHARRAY:30
                CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
                CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
                CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
                CALL D3D_GET_RIGHT_COORD(RESULT:0,RESULT:1)
                CALL D3D_WALL_OR_FLOOR(RESULT:0,RESULT:1,3)
                SIF RESULT:2 == 0
                    LSKIP = 1
            ENDIF
        CASE 35;심도2왼쪽왼쪽칸앞벽
            IF LSWITCHARRAY:23
                CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
                CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
                CALL D3D_GET_LEFT_COORD(RESULT:0,RESULT:1)
                CALL D3D_GET_LEFT_COORD(RESULT:0,RESULT:1)
                CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
                CALL D3D_WALL_OR_FLOOR(RESULT:0,RESULT:1)
                SIF RESULT:2 == 0
                    LSKIP = 1
            ENDIF
        CASE 36;심도2오른쪽오른쪽칸앞벽
            IF LSWITCHARRAY:24
                CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
                CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
                CALL D3D_GET_RIGHT_COORD(RESULT:0,RESULT:1)
                CALL D3D_GET_RIGHT_COORD(RESULT:0,RESULT:1)
                CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
                CALL D3D_WALL_OR_FLOOR(RESULT:0,RESULT:1)
                SIF RESULT:2 == 0
                    LSKIP = 1
            ENDIF
        CASE 37;심도2왼쪽왼쪽칸왼쪽벽
            IF LSWITCHARRAY:27
                CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
                CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
                CALL D3D_GET_LEFT_COORD(RESULT:0,RESULT:1)
                CALL D3D_GET_LEFT_COORD(RESULT:0,RESULT:1)
                CALL D3D_WALL_OR_FLOOR(RESULT:0,RESULT:1,1)
                SIF RESULT:2 == 0
                    LSKIP = 1
            ENDIF
        CASE 38;심도2오른쪽오른쪽칸오른쪽벽
            IF LSWITCHARRAY:28
                CALL D3D_GET_FRONT_COORD(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
                CALL D3D_GET_FRONT_COORD(RESULT:0,RESULT:1)
                CALL D3D_GET_RIGHT_COORD(RESULT:0,RESULT:1)
                CALL D3D_GET_RIGHT_COORD(RESULT:0,RESULT:1)
                CALL D3D_WALL_OR_FLOOR(RESULT:0,RESULT:1,3)
                SIF RESULT:2 == 0
                    LSKIP = 1
            ENDIF
        CASEELSE
            D3D_TEXTBUTTON:LCOUNT = 0;이 부분은 에러 회피용
            D3D_TEXTBUTTONS:LCOUNT '= "　"
            D3D_TEXTBUTTONCOORD:LCOUNT:0 = 0,0
            GETDEFCOLOR
            D3D_TEXTBUTTONC:LCOUNT = RESULT
            CONTINUE
    ENDSELECT
    D3D_TEXTBUTTONCOORD:LCOUNT:0 = RESULT:0,RESULT:1
    ;맵으로부터 타일 아이콘 문자열 값을 취득
    IF (RESULT:0 >= 0 && RESULT:0 < D3D_CURRENT_MAPXSIZE && RESULT:1 >= 0 && RESULT:1 < D3D_CURRENT_MAPYSIZE) && LSKIP == 0
        CALL D3D_GET_TILE(RESULT:0,RESULT:1)
    ENDIF
    CALL D3D_SPIN_TILES(RESULTS)
    ;목표 좌표가 일반적인 벽 또는 바닥이라 표시할 내용이 없다면 비운다 
    IF (RESULTS == "■" || RESULTS == "□" || RESULTS == "" || RESULTS == "　") || LSKIP != 0
        D3D_TEXTBUTTON:LCOUNT = 0
        D3D_TEXTBUTTONS:LCOUNT '= "　"
        D3D_TEXTBUTTONCOORD:LCOUNT:0 = 0,0
        GETDEFCOLOR
        D3D_TEXTBUTTONC:LCOUNT = RESULT
    ELSE
        ;전장의 안개라면 ? 로 표시
        {
            IF D3D_BSW:(FLAG:탐색대상던전):(D3D_TEXTBUTTONCOORD:LCOUNT:0):(D3D_TEXTBUTTONCOORD:LCOUNT:1) == 0 &&
            DEBUG_BSW == 0
        }
            D3D_TEXTBUTTON:LCOUNT = 1
            D3D_TEXTBUTTONS:LCOUNT '= "？"
            GETDEFCOLOR
            D3D_TEXTBUTTONC:LCOUNT = RESULT
            CONTINUE
        ELSE
            ;그게 아니라면 획득한 문자열과 색상 값을 각 배열변수에 저장한다
            D3D_TEXTBUTTON:LCOUNT = 1
            D3D_TEXTBUTTONS:LCOUNT = %RESULTS%
            GETCOLOR
            D3D_TEXTBUTTONC:LCOUNT = RESULT
            CONTINUE
        ENDIF
    ENDIF
NEXT
RESETCOLOR
RESULTS =

CALL D3D_MAKE_MINIMAP

;여기에 맵 아이콘 표시 기능 작성
;보다 아래에 있는 코드에서 표시하는 HTML_PRINT 그래픽들과 겹치는 위치에 작성된다
;또한 반복문을 거듭할 때마다 나침반, 미니맵 등을 그리는 함수를 호출한다
FOR LCOUNT,0,24
    SELECTCASE LCOUNT
        CASE 11
            PRINT_SPACE 100
            IF D3D_TEXTBUTTON:4
                CALL PRINT_TEXTBUTTON(4)
            ELSEIF D3D_TEXTBUTTON:35
                CALL PRINT_TEXTBUTTON(35)
            ELSEIF D3D_TEXTBUTTON:37
                CALL PRINT_TEXTBUTTON(37)
            ELSE
                PRINT_SPACE 300
            ENDIF
            IF D3D_TEXTBUTTON:3
                PRINT_SPACE 100
                CALL PRINT_TEXTBUTTON(3)
            ELSEIF D3D_TEXTBUTTON:1
                CALL PRINT_TEXTBUTTON(1)
                PRINT_SPACE 100
            ELSE
                PRINT_SPACE 400
            ENDIF
            IF D3D_TEXTBUTTON:7
                CALL PRINT_TEXTBUTTON(7)
            ELSE
                PRINT_SPACE 300
            ENDIF
            IF D3D_TEXTBUTTON:25
                CALL PRINT_TEXTBUTTON(25)
            ELSEIF D3D_TEXTBUTTON:31
                CALL PRINT_TEXTBUTTON(31)
            ELSE
                PRINT_SPACE 300
            ENDIF
            IF D3D_TEXTBUTTON:33
                CALL PRINT_TEXTBUTTON(33)
            ELSE
                PRINT_SPACE 300
            ENDIF
            PRINT_SPACE 100
            IF D3D_TEXTBUTTON:0
                CALL PRINT_TEXTBUTTON(0)
            ELSEIF D3D_TEXTBUTTON:15
                CALL PRINT_TEXTBUTTON(15)
            ELSEIF D3D_TEXTBUTTON:16
                CALL PRINT_TEXTBUTTON(16)
            ELSEIF D3D_TEXTBUTTON:17
                CALL PRINT_TEXTBUTTON(17)
            ELSE
                PRINT_SPACE 300
            ENDIF
            PRINT_SPACE 200
            IF D3D_TEXTBUTTON:34
                CALL PRINT_TEXTBUTTON(34)
            ELSE
                PRINT_SPACE 300
            ENDIF
            IF D3D_TEXTBUTTON:26
                CALL PRINT_TEXTBUTTON(26)
            ELSEIF D3D_TEXTBUTTON:32
                CALL PRINT_TEXTBUTTON(32)
            ELSE
                PRINT_SPACE 300
            ENDIF
            IF D3D_TEXTBUTTON:8
                CALL PRINT_TEXTBUTTON(8)
            ELSE
                PRINT_SPACE 300
            ENDIF
            IF D3D_TEXTBUTTON:5
                CALL PRINT_TEXTBUTTON(5)
                PRINT_SPACE 100
            ELSEIF D3D_TEXTBUTTON:2
                PRINT_SPACE 100
                CALL PRINT_TEXTBUTTON(2)
            ELSE
                PRINT_SPACE 400
            ENDIF
            IF D3D_TEXTBUTTON:6
                CALL PRINT_TEXTBUTTON(6)
            ELSEIF D3D_TEXTBUTTON:36
                CALL PRINT_TEXTBUTTON(36)
            ELSEIF D3D_TEXTBUTTON:38
                CALL PRINT_TEXTBUTTON(38)
            ELSE
                PRINT_SPACE 300
            ENDIF
            PRINT_SPACE 100
        CASE 14
            PRINT_SPACE 1000
            IF D3D_TEXTBUTTON:29
                CALL PRINT_TEXTBUTTON(29)
            ELSE
                PRINT_SPACE 300
            ENDIF
            PRINT_SPACE 500
            IF D3D_TEXTBUTTON:18
                CALL PRINT_TEXTBUTTON(18)
            ELSE
                PRINT_SPACE 300
            ENDIF
            PRINT_SPACE 500
            IF D3D_TEXTBUTTON:30
                CALL PRINT_TEXTBUTTON(30)
            ELSE
                PRINT_SPACE 300
            ENDIF
            PRINT_SPACE 1100
        CASE 16
            PRINT_SPACE 200
            IF D3D_TEXTBUTTON:27
                CALL PRINT_TEXTBUTTON(27)
            ELSE
                PRINT_SPACE 300
            ENDIF
            PRINT_SPACE 200
            IF D3D_TEXTBUTTON:10
                CALL PRINT_TEXTBUTTON(10)
            ELSE
                PRINT_SPACE 300
            ENDIF
            IF D3D_TEXTBUTTON:21
                CALL PRINT_TEXTBUTTON(21)
            ELSE
                PRINT_SPACE 300
            ENDIF
            PRINT_SPACE 500
            IF D3D_TEXTBUTTON:9
                CALL PRINT_TEXTBUTTON(9)
            ELSE
                PRINT_SPACE 300
            ENDIF
            PRINT_SPACE 500
            IF D3D_TEXTBUTTON:22
                CALL PRINT_TEXTBUTTON(22)
            ELSE
                PRINT_SPACE 300
            ENDIF
            IF D3D_TEXTBUTTON:11
                CALL PRINT_TEXTBUTTON(11)
            ELSE
                PRINT_SPACE 300
            ENDIF
            PRINT_SPACE 300
            IF D3D_TEXTBUTTON:28
                CALL PRINT_TEXTBUTTON(28)
            ELSE
                PRINT_SPACE 300
            ENDIF
            PRINT_SPACE 200
        CASE 19
            PRINT_SPACE 100
            IF D3D_TEXTBUTTON:19
                CALL PRINT_TEXTBUTTON(19)
            ELSE
                PRINT_SPACE 300
            ENDIF
            IF D3D_TEXTBUTTON:13
                CALL PRINT_TEXTBUTTON(13)
            ELSE
                PRINT_SPACE 300
            ENDIF
            PRINT_SPACE 1100
            IF D3D_TEXTBUTTON:12
                CALL PRINT_TEXTBUTTON(12)
            ELSE
                PRINT_SPACE 300
            ENDIF
            PRINT_SPACE 1100
            IF D3D_TEXTBUTTON:14
                CALL PRINT_TEXTBUTTON(14)
            ELSE
                PRINT_SPACE 300
            ENDIF
            PRINT_SPACE 100
            IF D3D_TEXTBUTTON:20
                CALL PRINT_TEXTBUTTON(20)
            ELSE
                PRINT_SPACE 300
            ENDIF
            PRINT_SPACE 100
        CASE 23
            PRINT_SPACE 100
            IF D3D_TEXTBUTTON:23
                CALL PRINT_TEXTBUTTON(23)
            ELSE
                PRINT_SPACE 300
            ENDIF
            PRINT_SPACE 3200
            IF D3D_TEXTBUTTON:24
                CALL PRINT_TEXTBUTTON(24)
            ELSE
                PRINT_SPACE 300
            ENDIF
            PRINT_SPACE 100
        CASE 0 TO 10
            ;거대보스전 (외) 엑스트라 UI
            CALL PRINT_3D_EXTRA(LCOUNT)
        CASEELSE
            PRINT_SPACE 4000
    ENDSELECT
    RESETCOLOR
    IF GIANT_BATTLE != 0
        ;거대보스전의 경우 별도의 UI 표기
        CALL PRINT_3D_EXTRA(LCOUNT,1)
    ELSE
        IF LCOUNT < 3
            ;나침반 출력
            CALL D3D_SHOW_COMPASS(LCOUNT)
            IF LCOUNT == 0
                PRINT_SPACE 200
                PRINTFORM 탐색중 : %DUNGEONNAME:(FLAG:탐색대상던전)%
            ENDIF
        ELSEIF LCOUNT == 4
            ;발 밑의 오브젝트 여부 출력
            CALL D3D_SHOW_UNDER_YOU
        ELSEIF LCOUNT >= 24-((D3D_MINIMAP_RADIUS*2)+1) && LCOUNT < 24
            ;미니맵 출력
            FOR LCOUNT2,0,((D3D_MINIMAP_RADIUS*2)+1)
                ;LCOUNT2를 X좌표, LCOUNT는 Y좌표로 이용
                SETCOLOR D3D_MINIMAPS_C:LCOUNT2:(LCOUNT-(24-((D3D_MINIMAP_RADIUS*2)+1)))
                PRINTFORM %D3D_MINIMAPS:LCOUNT2:(LCOUNT-(24-((D3D_MINIMAP_RADIUS*2)+1))),1,LEFT%
                SELECTCASE D3D_MINIMAPS:LCOUNT2:(LCOUNT-(24-((D3D_MINIMAP_RADIUS*2)+1)))
                    CASE "⏶","⏵","⏷","⏴"
                        PRINT_SPACE 21
                    CASE "□","■"
                        PRINT_SPACE 10
                ENDSELECT
            NEXT
        ENDIF
    ENDIF
    RESETCOLOR
    SIF LCOUNT < 23
        PRINTL
NEXT

;HTMLTEXT 작성
HTMLTEXT '= @"<p align='left'><nobr>"
IF LSWITCHARRAY:0 == 1
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP0_DIAGONAL11P:0, D3D_DEEP0_DIAGONAL11P:1, D3D_DEEP0_DIAGONAL11P:2, D3D_DEEP0_DIAGONAL11P:3,"D3D_DIAGONALLINE_1")
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP0_DIAGONAL12P:0, D3D_DEEP0_DIAGONAL12P:1, D3D_DEEP0_DIAGONAL12P:2, D3D_DEEP0_DIAGONAL12P:3,"D3D_DIAGONALLINE_2")
ENDIF
IF LSWITCHARRAY:1 == 1
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP0_DIAGONAL21P:0, D3D_DEEP0_DIAGONAL21P:1, D3D_DEEP0_DIAGONAL21P:2, D3D_DEEP0_DIAGONAL21P:3,"D3D_DIAGONALLINE_2")
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP0_DIAGONAL22P:0, D3D_DEEP0_DIAGONAL22P:1, D3D_DEEP0_DIAGONAL22P:2, D3D_DEEP0_DIAGONAL22P:3,"D3D_DIAGONALLINE_1")
ENDIF
IF LSWITCHARRAY:2 == 1
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP0_HORIZONTAL01P:0, D3D_DEEP0_HORIZONTAL01P:1, D3D_DEEP0_HORIZONTAL01P:2, D3D_DEEP0_HORIZONTAL01P:3,"D3D_HORIZONTALLINE")
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP0_HORIZONTAL02P:0, D3D_DEEP0_HORIZONTAL02P:1, D3D_DEEP0_HORIZONTAL02P:2, D3D_DEEP0_HORIZONTAL02P:3,"D3D_HORIZONTALLINE")
ENDIF
IF LSWITCHARRAY:3 == 1
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP0_HORIZONTAL11P:0, D3D_DEEP0_HORIZONTAL11P:1, D3D_DEEP0_HORIZONTAL11P:2, D3D_DEEP0_HORIZONTAL11P:3,"D3D_HORIZONTALLINE")
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP0_HORIZONTAL12P:0, D3D_DEEP0_HORIZONTAL12P:1, D3D_DEEP0_HORIZONTAL12P:2, D3D_DEEP0_HORIZONTAL12P:3,"D3D_HORIZONTALLINE")
ENDIF
IF LSWITCHARRAY:4 == 1
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP0_HORIZONTAL21P:0, D3D_DEEP0_HORIZONTAL21P:1, D3D_DEEP0_HORIZONTAL21P:2, D3D_DEEP0_HORIZONTAL21P:3,"D3D_HORIZONTALLINE")
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP0_HORIZONTAL22P:0, D3D_DEEP0_HORIZONTAL22P:1, D3D_DEEP0_HORIZONTAL22P:2, D3D_DEEP0_HORIZONTAL22P:3,"D3D_HORIZONTALLINE")
ENDIF
SIF LSWITCHARRAY:5 == 1
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP0_VERTICAL01P:0, D3D_DEEP0_VERTICAL01P:1, D3D_DEEP0_VERTICAL01P:2, D3D_DEEP0_VERTICAL01P:3,"D3D_VERTICALLINE")
SIF LSWITCHARRAY:6 == 1
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP0_VERTICAL02P:0, D3D_DEEP0_VERTICAL02P:1, D3D_DEEP0_VERTICAL02P:2, D3D_DEEP0_VERTICAL02P:3,"D3D_VERTICALLINE")
IF LSWITCHARRAY:7 == 1
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP1_DIAGONAL11P:0, D3D_DEEP1_DIAGONAL11P:1, D3D_DEEP1_DIAGONAL11P:2, D3D_DEEP1_DIAGONAL11P:3,"D3D_DIAGONALLINE_1")
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP1_DIAGONAL12P:0, D3D_DEEP1_DIAGONAL12P:1, D3D_DEEP1_DIAGONAL12P:2, D3D_DEEP1_DIAGONAL12P:3,"D3D_DIAGONALLINE_2")
ENDIF
IF LSWITCHARRAY:8 == 1
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP1_DIAGONAL21P:0, D3D_DEEP1_DIAGONAL21P:1, D3D_DEEP1_DIAGONAL21P:2, D3D_DEEP1_DIAGONAL21P:3,"D3D_DIAGONALLINE_2")
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP1_DIAGONAL22P:0, D3D_DEEP1_DIAGONAL22P:1, D3D_DEEP1_DIAGONAL22P:2, D3D_DEEP1_DIAGONAL22P:3,"D3D_DIAGONALLINE_1")
ENDIF
IF LSWITCHARRAY:9 == 1
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP1_HORIZONTAL01P:0, D3D_DEEP1_HORIZONTAL01P:1, D3D_DEEP1_HORIZONTAL01P:2, D3D_DEEP1_HORIZONTAL01P:3,"D3D_HORIZONTALLINE")
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP1_HORIZONTAL02P:0, D3D_DEEP1_HORIZONTAL02P:1, D3D_DEEP1_HORIZONTAL02P:2, D3D_DEEP1_HORIZONTAL02P:3,"D3D_HORIZONTALLINE")
ENDIF
IF LSWITCHARRAY:10 == 1
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP1_HORIZONTAL11P:0, D3D_DEEP1_HORIZONTAL11P:1, D3D_DEEP1_HORIZONTAL11P:2, D3D_DEEP1_HORIZONTAL11P:3,"D3D_HORIZONTALLINE")
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP1_HORIZONTAL12P:0, D3D_DEEP1_HORIZONTAL12P:1, D3D_DEEP1_HORIZONTAL12P:2, D3D_DEEP1_HORIZONTAL12P:3,"D3D_HORIZONTALLINE")
ENDIF
IF LSWITCHARRAY:11 == 1
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP1_HORIZONTAL21P:0, D3D_DEEP1_HORIZONTAL21P:1, D3D_DEEP1_HORIZONTAL21P:2, D3D_DEEP1_HORIZONTAL21P:3,"D3D_HORIZONTALLINE")
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP1_HORIZONTAL22P:0, D3D_DEEP1_HORIZONTAL22P:1, D3D_DEEP1_HORIZONTAL22P:2, D3D_DEEP1_HORIZONTAL22P:3,"D3D_HORIZONTALLINE")
ENDIF
IF LSWITCHARRAY:12 == 1
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP1_HORIZONTAL31P:0, D3D_DEEP1_HORIZONTAL31P:1, D3D_DEEP1_HORIZONTAL31P:2, D3D_DEEP1_HORIZONTAL31P:3,"D3D_HORIZONTALLINE")
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP1_HORIZONTAL32P:0, D3D_DEEP1_HORIZONTAL32P:1, D3D_DEEP1_HORIZONTAL32P:2, D3D_DEEP1_HORIZONTAL32P:3,"D3D_HORIZONTALLINE")
ENDIF
IF LSWITCHARRAY:13 == 1
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP1_HORIZONTAL41P:0, D3D_DEEP1_HORIZONTAL41P:1, D3D_DEEP1_HORIZONTAL41P:2, D3D_DEEP1_HORIZONTAL41P:3,"D3D_HORIZONTALLINE")
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP1_HORIZONTAL42P:0, D3D_DEEP1_HORIZONTAL42P:1, D3D_DEEP1_HORIZONTAL42P:2, D3D_DEEP1_HORIZONTAL42P:3,"D3D_HORIZONTALLINE")
ENDIF
SIF LSWITCHARRAY:14 == 1
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP1_VERTICAL01P:0, D3D_DEEP1_VERTICAL01P:1, D3D_DEEP1_VERTICAL01P:2, D3D_DEEP1_VERTICAL01P:3,"D3D_VERTICALLINE")
SIF LSWITCHARRAY:15 == 1
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP1_VERTICAL02P:0, D3D_DEEP1_VERTICAL02P:1, D3D_DEEP1_VERTICAL02P:2, D3D_DEEP1_VERTICAL02P:3,"D3D_VERTICALLINE")
IF LSWITCHARRAY:16 == 1
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP2_DIAGONAL11P:0, D3D_DEEP2_DIAGONAL11P:1, D3D_DEEP2_DIAGONAL11P:2, D3D_DEEP2_DIAGONAL11P:3,"D3D_DIAGONALLINE_1")
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP2_DIAGONAL12P:0, D3D_DEEP2_DIAGONAL12P:1, D3D_DEEP2_DIAGONAL12P:2, D3D_DEEP2_DIAGONAL12P:3,"D3D_DIAGONALLINE_2")
ENDIF
IF LSWITCHARRAY:17 == 1
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP2_DIAGONAL21P:0, D3D_DEEP2_DIAGONAL21P:1, D3D_DEEP2_DIAGONAL21P:2, D3D_DEEP2_DIAGONAL21P:3,"D3D_DIAGONALLINE_2")
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP2_DIAGONAL22P:0, D3D_DEEP2_DIAGONAL22P:1, D3D_DEEP2_DIAGONAL22P:2, D3D_DEEP2_DIAGONAL22P:3,"D3D_DIAGONALLINE_1")
ENDIF
IF LSWITCHARRAY:18 == 1
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP2_HORIZONTAL01P:0, D3D_DEEP2_HORIZONTAL01P:1, D3D_DEEP2_HORIZONTAL01P:2, D3D_DEEP2_HORIZONTAL01P:3,"D3D_HORIZONTALLINE")
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP2_HORIZONTAL02P:0, D3D_DEEP2_HORIZONTAL02P:1, D3D_DEEP2_HORIZONTAL02P:2, D3D_DEEP2_HORIZONTAL02P:3,"D3D_HORIZONTALLINE")
ENDIF
IF LSWITCHARRAY:19 == 1
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP2_HORIZONTAL11P:0, D3D_DEEP2_HORIZONTAL11P:1, D3D_DEEP2_HORIZONTAL11P:2, D3D_DEEP2_HORIZONTAL11P:3,"D3D_HORIZONTALLINE")
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP2_HORIZONTAL12P:0, D3D_DEEP2_HORIZONTAL12P:1, D3D_DEEP2_HORIZONTAL12P:2, D3D_DEEP2_HORIZONTAL12P:3,"D3D_HORIZONTALLINE")
ENDIF
IF LSWITCHARRAY:20 == 1
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP2_HORIZONTAL21P:0, D3D_DEEP2_HORIZONTAL21P:1, D3D_DEEP2_HORIZONTAL21P:2, D3D_DEEP2_HORIZONTAL21P:3,"D3D_HORIZONTALLINE")
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP2_HORIZONTAL22P:0, D3D_DEEP2_HORIZONTAL22P:1, D3D_DEEP2_HORIZONTAL22P:2, D3D_DEEP2_HORIZONTAL22P:3,"D3D_HORIZONTALLINE")
ENDIF
IF LSWITCHARRAY:21 == 1
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP2_HORIZONTAL31P:0, D3D_DEEP2_HORIZONTAL31P:1, D3D_DEEP2_HORIZONTAL31P:2, D3D_DEEP2_HORIZONTAL31P:3,"D3D_HORIZONTALLINE")
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP2_HORIZONTAL32P:0, D3D_DEEP2_HORIZONTAL32P:1, D3D_DEEP2_HORIZONTAL32P:2, D3D_DEEP2_HORIZONTAL32P:3,"D3D_HORIZONTALLINE")
ENDIF
IF LSWITCHARRAY:22 == 1
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP2_HORIZONTAL41P:0, D3D_DEEP2_HORIZONTAL41P:1, D3D_DEEP2_HORIZONTAL41P:2, D3D_DEEP2_HORIZONTAL41P:3,"D3D_HORIZONTALLINE")
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP2_HORIZONTAL42P:0, D3D_DEEP2_HORIZONTAL42P:1, D3D_DEEP2_HORIZONTAL42P:2, D3D_DEEP2_HORIZONTAL42P:3,"D3D_HORIZONTALLINE")
ENDIF
IF LSWITCHARRAY:23 == 1
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP2_HORIZONTAL51P:0, D3D_DEEP2_HORIZONTAL51P:1, D3D_DEEP2_HORIZONTAL51P:2, D3D_DEEP2_HORIZONTAL51P:3,"D3D_HORIZONTALLINE")
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP2_HORIZONTAL52P:0, D3D_DEEP2_HORIZONTAL52P:1, D3D_DEEP2_HORIZONTAL52P:2, D3D_DEEP2_HORIZONTAL52P:3,"D3D_HORIZONTALLINE")
ENDIF
IF LSWITCHARRAY:24 == 1
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP2_HORIZONTAL61P:0, D3D_DEEP2_HORIZONTAL61P:1, D3D_DEEP2_HORIZONTAL61P:2, D3D_DEEP2_HORIZONTAL61P:3,"D3D_HORIZONTALLINE")
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP2_HORIZONTAL62P:0, D3D_DEEP2_HORIZONTAL62P:1, D3D_DEEP2_HORIZONTAL62P:2, D3D_DEEP2_HORIZONTAL62P:3,"D3D_HORIZONTALLINE")
ENDIF
SIF LSWITCHARRAY:25 == 1
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP2_VERTICAL01P:0, D3D_DEEP2_VERTICAL01P:1, D3D_DEEP2_VERTICAL01P:2, D3D_DEEP2_VERTICAL01P:3,"D3D_VERTICALLINE")
SIF LSWITCHARRAY:26 == 1
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP2_VERTICAL02P:0, D3D_DEEP2_VERTICAL02P:1, D3D_DEEP2_VERTICAL02P:2, D3D_DEEP2_VERTICAL02P:3,"D3D_VERTICALLINE")

IF LSWITCHARRAY:27 == 1
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP2_DIAGONAL31P:0, D3D_DEEP2_DIAGONAL31P:1, D3D_DEEP2_DIAGONAL31P:2, D3D_DEEP2_DIAGONAL31P:3,"D3D_DIAGONALLINE_1")
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP2_DIAGONAL32P:0, D3D_DEEP2_DIAGONAL32P:1, D3D_DEEP2_DIAGONAL32P:2, D3D_DEEP2_DIAGONAL32P:3,"D3D_DIAGONALLINE_2")
ENDIF
IF LSWITCHARRAY:28 == 1
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP2_DIAGONAL41P:0, D3D_DEEP2_DIAGONAL41P:1, D3D_DEEP2_DIAGONAL41P:2, D3D_DEEP2_DIAGONAL41P:3,"D3D_DIAGONALLINE_2")
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP2_DIAGONAL42P:0, D3D_DEEP2_DIAGONAL42P:1, D3D_DEEP2_DIAGONAL42P:2, D3D_DEEP2_DIAGONAL42P:3,"D3D_DIAGONALLINE_1")
ENDIF
IF LSWITCHARRAY:29 == 1
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP3_DIAGONAL11P:0, D3D_DEEP3_DIAGONAL11P:1, D3D_DEEP3_DIAGONAL11P:2, D3D_DEEP3_DIAGONAL11P:3,"D3D_DIAGONALLINE_1")
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP3_DIAGONAL12P:0, D3D_DEEP3_DIAGONAL12P:1, D3D_DEEP3_DIAGONAL12P:2, D3D_DEEP3_DIAGONAL12P:3,"D3D_DIAGONALLINE_2")
ENDIF
IF LSWITCHARRAY:30 == 1
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP3_DIAGONAL21P:0, D3D_DEEP3_DIAGONAL21P:1, D3D_DEEP3_DIAGONAL21P:2, D3D_DEEP3_DIAGONAL21P:3,"D3D_DIAGONALLINE_2")
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP3_DIAGONAL22P:0, D3D_DEEP3_DIAGONAL22P:1, D3D_DEEP3_DIAGONAL22P:2, D3D_DEEP3_DIAGONAL22P:3,"D3D_DIAGONALLINE_1")
ENDIF
SIF LSWITCHARRAY:31 == 1
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP2_VERTICAL11P:0, D3D_DEEP2_VERTICAL11P:1, D3D_DEEP2_VERTICAL11P:2, D3D_DEEP2_VERTICAL11P:3,"D3D_VERTICALLINE")
SIF LSWITCHARRAY:32 == 1
    HTMLTEXT += D3D_MAKE_HTMLTEXT(D3D_DEEP2_VERTICAL12P:0, D3D_DEEP2_VERTICAL12P:1, D3D_DEEP2_VERTICAL12P:2, D3D_DEEP2_VERTICAL12P:3,"D3D_VERTICALLINE")

HTML_PRINT @"%HTMLTEXT%"

;유사HTML요소를 작성 각 인수는 DUNGEON3D.ERH에 정의된 상수배열변수:0~3, 스프라이트 이름
;각각 출력하는 길이, 너비, 상하 높이, 좌우 위치, 파일 이름
@D3D_MAKE_HTMLTEXT(LHEIGHT,LWIDTH,LYPOS,LXPOS,SRCNAME)
#FUNCTIONS
#DIM DYNAMIC LHEIGHT
#DIM DYNAMIC LWIDTH
#DIM DYNAMIC LYPOS
#DIM DYNAMIC LXPOS
#DIMS DYNAMIC SRCNAME

RETURNF @"<nonbutton title='...' pos='{LXPOS * 50}'><img src='" + SRCNAME + @"' height='{LHEIGHT * 50}' width='{LWIDTH * 50}' ypos='{LYPOS * 50}'></nonbutton>"

;나침반 표시
@D3D_SHOW_COMPASS(LINENUM)
#DIM DYNAMIC LINENUM
SELECTCASE LINENUM
    CASE 0
        SELECTCASE D3D_PLAYER_DIRECTION
            CASE 0
                SETCOLORBYNAME Red
                PRINT 　Ｎ
                RESETCOLOR
            CASE 1
                PRINT 　Ｅ
            CASE 2
                PRINT 　Ｓ
            CASE 3
                PRINT 　Ｗ
        ENDSELECT
    CASE 1
        SELECTCASE D3D_PLAYER_DIRECTION
            CASE 0
                PRINT Ｗ△Ｅ
            CASE 1
                SETCOLORBYNAME Red
                PRINT Ｎ
                RESETCOLOR
                PRINT △Ｓ
            CASE 2
                PRINT Ｅ△Ｗ
            CASE 3
                PRINT Ｓ△
                SETCOLORBYNAME Red
                PRINT Ｎ
                RESETCOLOR
        ENDSELECT
    CASE 2
        SELECTCASE D3D_PLAYER_DIRECTION
            CASE 0
                PRINT 　Ｓ　
            CASE 1
                PRINT 　Ｗ　
            CASE 2
                SETCOLORBYNAME Red
                PRINT 　Ｎ　
                RESETCOLOR
            CASE 3
                PRINT 　Ｅ　
        ENDSELECT
ENDSELECT

@D3D_SHOW_UNDER_YOU
CALL D3D_GET_TILE(D3D_PLAYER_XCOORD,D3D_PLAYER_YCOORD)
IF RESULTS == "출" || RESULTS == "出"
    PRINTPLAINFORM [%RESULTS%]
    RESETCOLOR
    PRINT 출구 위에 서 있다
ELSEIF RESULTS == "강" || RESULTS == "승" || RESULTS == "降" || RESULTS == "昇"
    PRINTPLAINFORM [%RESULTS%]
    RESETCOLOR
    PRINT 계단 위에 서 있다
ELSEIF RESULTS == "■"
    RESETCOLOR
    PRINT ???
ELSEIF (RESULTS == "문" || RESULTS == "扉") && D3D_CURRENT_MAPDATA:D3D_PLAYER_XCOORD:D3D_PLAYER_YCOORD == 12
    PRINTPLAINFORM [%RESULTS%]
    RESETCOLOR
    PRINT 문턱 위에 서 있다
ELSEIF RESULTS != "" && RESULTS != "□"
    PRINTPLAINFORM [%RESULTS%]
    RESETCOLOR
    PRINT 이 위치에서 조사할 수 있다
ELSE
    RESETCOLOR
    PRINT 이 위치에는 아무것도 없는 것 같다
ENDIF

;미니맵을 D3D_MINIMAPS 문자열배열변수 및 D3D_MINIMAPS_C (색상) 에 작성하여 보존
@D3D_MAKE_MINIMAP
#DIM DYNAMIC LCOUNT
#DIM DYNAMIC LCOUNT2
;초기화
FOR LCOUNT,0,19
    FOR LCOUNT2,0,19
        D3D_MINIMAPS:LCOUNT:LCOUNT2 =
        D3D_MINIMAPS_C:LCOUNT:LCOUNT2 = 0
    NEXT
NEXT

FOR LCOUNT2, 0, 19
    FOR LCOUNT, 0, 19
        IF LCOUNT == D3D_PLAYER_XCOORD && LCOUNT2 == D3D_PLAYER_YCOORD
            SETCOLOR 0x33ffcc
            SELECTCASE D3D_PLAYER_DIRECTION
                CASE 0
                    D3D_MINIMAPS:LCOUNT:LCOUNT2 = ⏶
                CASE 1
                    D3D_MINIMAPS:LCOUNT:LCOUNT2 = ⏵
                CASE 2
                    D3D_MINIMAPS:LCOUNT:LCOUNT2 = ⏷
                CASE 3
                    D3D_MINIMAPS:LCOUNT:LCOUNT2 = ⏴
            ENDSELECT
            GETCOLOR
            D3D_MINIMAPS_C:LCOUNT:LCOUNT2 = RESULT
            RESETCOLOR
            CONTINUE
        ELSE
            {
                IF D3D_BSW:(FLAG:탐색대상던전):LCOUNT:LCOUNT2 == 0 &&
                DEBUG_BSW == 0
            }
                D3D_MINIMAPS:LCOUNT:LCOUNT2 '= "　"
                GETDEFCOLOR
                D3D_MINIMAPS_C:LCOUNT:LCOUNT2 = RESULT
            ELSE
                CALL D3D_GET_TILE(LCOUNT,LCOUNT2)
                D3D_MINIMAPS:LCOUNT:LCOUNT2 = %RESULTS%
                GETCOLOR
                D3D_MINIMAPS_C:LCOUNT:LCOUNT2 = RESULT
            ENDIF
        ENDIF
    NEXT
NEXT

;화살표 타일을 방향에 맞춰 회전시키는 코드
@D3D_SPIN_TILES(TILES)
#DIM DYNAMIC LCOUNT
#DIMS DYNAMIC TILES
#DIMS DYNAMIC TILEARRAY0,4
#DIMS DYNAMIC TILEARRAY1,4
#DIMS DYNAMIC TILEARRAY2,4
;#DIMS DYNAMIC TILEARRAY3,4
;화살표 타일을 추가로 등록하려면 여기에 정의(1/4)
#DIM DYNAMIC TARGET_0=-1
#DIM DYNAMIC TARGET_1=-1
#DIMS DYNAMIC FORMSTRING
#DIM DYNAMIC DIRECTIONARRAY,4,4
IF TILES == "" || TILES == " "
    RESULTS = %TILES%
    GOTO D3D_END_SPIN_TILES
ENDIF

DIRECTIONARRAY:0:0 = 0,1,2,3
DIRECTIONARRAY:1:0 = 3,0,1,2
DIRECTIONARRAY:2:0 = 2,3,0,1
DIRECTIONARRAY:3:0 = 1,2,3,0
TILEARRAY0:0 '= "↑","→","↓","←"
TILEARRAY1:0 '= "∧","＞","∨","＜"
TILEARRAY2:0 '= "△","≫","▽","≪"
;TILEARRAY3:0 '= "ㅁ","ㄴ","ㅇ","ㄹ"
;화살표 타일을 추가로 등록하려면 여기에 정의(2/4)
FOR LCOUNT,0,3
    SELECTCASE LCOUNT   
        CASE 0
            FINDELEMENT TILEARRAY0,TILES,0,4
        CASE 1
            FINDELEMENT TILEARRAY1,TILES,0,4
        CASE 2
            FINDELEMENT TILEARRAY2,TILES,0,4
        ;CASE 3
            ;FINDELEMENT TILEARRAY3,TILES,0,4
        ;화살표 타일을 추가로 등록하려면 여기에 정의(3/4)
    ENDSELECT
    IF RESULT != -1
        TARGET_0 = LCOUNT
        TARGET_1 = RESULT
        BREAK
    ELSE
        CONTINUE
    ENDIF
NEXT
IF TARGET_0 == -1 || TARGET_1 == -1
    RESULTS = %TILES%
    GOTO D3D_END_SPIN_TILES
ENDIF
TARGET_1 = DIRECTIONARRAY:D3D_PLAYER_DIRECTION:TARGET_1
SELECTCASE TARGET_0
    CASE 0
        RESULTS = %TILEARRAY0:TARGET_1%
    CASE 1
        RESULTS = %TILEARRAY1:TARGET_1%
    CASE 2
        RESULTS = %TILEARRAY2:TARGET_1%
    ;CASE 3
        ;RESULTS = %TILEARRAY3:TARGET_1%
    ;화살표 타일을 추가로 등록하려면 여기에 정의(4/4)
ENDSELECT
$D3D_END_SPIN_TILES

;텍스트 버튼 출력 함수
;원거리 상호작용 대응이 목표
@PRINT_TEXTBUTTON(KEYV)
#DIM DYNAMIC KEYV
#DIMS DYNAMIC BUTTONS
SETCOLOR D3D_TEXTBUTTONC:KEYV
BUTTONS = [%D3D_TEXTBUTTONS:KEYV,1,LEFT%]

SELECTCASE D3D_CURRENT_MAPDATA:(D3D_TEXTBUTTONCOORD:KEYV:0):(D3D_TEXTBUTTONCOORD:KEYV:1)
    CASE 24,34
        PRINT_SPACE 50
        PRINTBUTTON @"[%D3D_TEXTBUTTONSYMBOL:KEYV%]",D3D_TEXTBUTTONSYMBOL:KEYV
        SELECTCASE KEYV
            CASE 0,16 TO 20
                PRINT_SPACE 35
        ENDSELECT   
        PRINTPLAIN  
        PRINT_SPACE 20
    CASEELSE
        PRINT_SPACE 50
        PRINTPLAINFORM %BUTTONS%
        PRINT_SPACE 50
ENDSELECT

@PRINT_3D_EXTRA(KEYV,SIDEV=0)
#DIM DYNAMIC KEYV
#DIM DYNAMIC SIDEV
IF SIDEV != 0
    ;HERE
    IF GIANT_BATTLE != 0
        CALL SHOW_GIANT_BATTLE_SIDE_INFO(KEYV)
    ENDIF
ELSE
    IF GIANT_BATTLE != 0
        CALL SHOW_GIANT_BATTLE_INFO(KEYV)
    ;ELSEIF ...
    ELSE
        PRINT_SPACE 4000
    ENDIF
ENDIF
RETURN 1